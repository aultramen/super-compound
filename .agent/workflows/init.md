---
description: "Initialize AI context for a new or imported project. Scans codebase, auto-fills project-config.md, and generates docs/codebase-map.md."
---

# Init Workflow

This workflow gives AI full context about an existing codebase. Use it when opening a project for the first time — especially projects imported from another IDE or freshly cloned.

## Why

Without initialization, AI treats existing projects as greenfield — generating generic plans that ignore existing files, patterns, and conventions. This workflow bridges the context gap.

## Steps

1. **Announce** — "Running codebase initialization. Scanning project structure and tech stack..."

2. **Read current config** — Read `.agent/rules/project-config.md`. Note which fields are already filled vs empty.

3. **Scan package files** — Look for and read these files (if they exist):
   - `package.json` → Node.js deps, scripts, framework hints
   - `composer.json` → PHP deps, autoload, framework hints
   - `requirements.txt` / `pyproject.toml` / `Pipfile` → Python deps
   - `go.mod` → Go modules
   - `Cargo.toml` → Rust crates
   - `Gemfile` → Ruby gems

4. **Scan config files** — Look for and read:
   - `tsconfig.json` → TypeScript config
   - `next.config.*` / `nuxt.config.*` / `vite.config.*` / `angular.json` → Framework config
   - `docker-compose.yml` / `Dockerfile` → Container setup
   - `.env.example` / `.env.sample` → Environment variables (never read `.env` itself)
   - `webpack.config.*` / `rollup.config.*` → Bundler config

5. **Scan framework markers** — Check for existence of:
   - `artisan` → Laravel
   - `manage.py` → Django
   - `next.config.js/ts` → Next.js
   - `nuxt.config.ts` → Nuxt
   - `angular.json` → Angular
   - `svelte.config.js` → SvelteKit

6. **Scan directory structure** — List top 3 levels of the project tree. Identify:
   - Source directories (src/, app/, lib/, pages/, components/)
   - Test directories (tests/, __tests__/, spec/)
   - Documentation (docs/, README)
   - Config/infra (.github/, .docker/, deploy/)

7. **Sample key source files** — Read 2-3 files per category to understand conventions:
   - Controllers / route handlers
   - Models / entities
   - Services / use cases
   - Components (frontend)
   - API routes

8. **Auto-fill project-config.md** — Update ONLY empty fields with detected values. Never overwrite user-set values. Present the diff to the user before applying.

9. **Generate `docs/codebase-map.md`** — Create with this structure:

   ```markdown
   # Codebase Map — [Project Name]

   > Auto-generated by `/init` on [date]. Review and edit as needed.

   ## Overview
   [1-2 paragraphs: what the project does, key features]

   ## Architecture
   - Pattern: [MVC/Clean/Layered/Modular]
   - Monorepo: [yes/no, list services if applicable]
   - API Style: [REST/GraphQL/gRPC]

   ## Directory Structure
   [Tree with descriptions for each major folder]

   ## Key Files
   | File | Purpose | Notes |
   |------|---------|-------|

   ## API Endpoints
   | Method | Path | Description |
   |--------|------|-------------|

   ## Conventions
   - Naming: [camelCase/snake_case/PascalCase]
   - Component style: [functional/class]
   - State management: [redux/zustand/context/vuex]
   - Import style: [absolute/relative/aliases]

   ## Tech Stack
   [Summary table from project-config.md]
   ```

10. **Present results** — Show the user:
    - Summary of detected tech stack
    - `project-config.md` changes (diff)
    - `docs/codebase-map.md` overview
    - Ask: "Does this look correct? Any corrections needed?"

## When to Use
- First time opening a project in this IDE
- After cloning/importing a project from another IDE (Cursor, Windsurf, etc.)
- When AI outputs feel generic or miss existing codebase context
- After major architectural changes (re-run to update map)

## When to Skip
- Brand new project (nothing to scan yet)
- Project already has filled `project-config.md` and `docs/codebase-map.md`
- Single-file scripts or trivial projects

## Future Extensions
- `--deep` — Scan ALL source files, generate API docs, analyze full dependency graph
- `--guided` — Interactive Q&A after scan for business context and domain knowledge
