---
description: "Initialize AI context for a new or imported project. Scans codebase, auto-fills project-config.md, and generates docs/codebase-map.md."
---

# Init Workflow

## Usage

```
/init           → Full initialization (scan + auto-fill config + generate docs)
/init reload    → Re-read all rule files mid-conversation (was /reload)
```

---

This workflow gives AI full context about an existing codebase. Use it when opening a project for the first time — especially projects imported from another IDE or freshly cloned.

## Why

Without initialization, AI treats existing projects as greenfield — generating generic plans that ignore existing files, patterns, and conventions. This workflow bridges the context gap.

## Steps

1. **Announce** — "Running codebase initialization. Scanning project structure and tech stack..."

2. **Read current config** — Read `.agent/rules/project-config.md`. Note which fields are already filled vs empty.

3. **Scan package files** — Look for and read these files (if they exist):
   - `package.json` → Node.js deps, scripts, framework hints
   - `composer.json` → PHP deps, autoload, framework hints
   - `requirements.txt` / `pyproject.toml` / `Pipfile` → Python deps
   - `go.mod` → Go modules
   - `Cargo.toml` → Rust crates
   - `Gemfile` → Ruby gems

4. **Scan config files** — Look for and read:
   - `tsconfig.json` → TypeScript config
   - `next.config.*` / `nuxt.config.*` / `vite.config.*` / `angular.json` → Framework config
   - `docker-compose.yml` / `Dockerfile` → Container setup
   - `.env.example` / `.env.sample` → Environment variables (never read `.env` itself)
   - `webpack.config.*` / `rollup.config.*` → Bundler config

5. **Scan framework markers** — Check for existence of:
   - `artisan` → Laravel
   - `manage.py` → Django
   - `next.config.js/ts` → Next.js
   - `nuxt.config.ts` → Nuxt
   - `angular.json` → Angular
   - `svelte.config.js` → SvelteKit

6. **Scan directory structure** — List top 3 levels of the project tree. Identify:
   - Source directories (src/, app/, lib/, pages/, components/)
   - Test directories (tests/, __tests__/, spec/)
   - Documentation (docs/, README)
   - Config/infra (.github/, .docker/, deploy/)

7. **Sample key source files** — Read 2-3 files per category to understand conventions:
   - Controllers / route handlers
   - Models / entities
   - Services / use cases
   - Components (frontend)
   - API routes

8. **Auto-fill project-config.md** — Update ONLY empty fields with detected values. Never overwrite user-set values. Present the diff to the user before applying.

9. **Generate codebase docs** — Create 7 specialized documents in `docs/codebase/`:

   | Document | Contents |
   |----------|----------|
   | `STACK.md` | Tech stack, versions, dependencies, build tools |
   | `ARCHITECTURE.md` | Architecture pattern, data flow, layers, API style |
   | `STRUCTURE.md` | Directory layout, file organization, entry points |
   | `CONVENTIONS.md` | Naming, coding style, patterns, import style |
   | `TESTING.md` | Test setup, frameworks, coverage, test commands |
   | `INTEGRATIONS.md` | External APIs, services, third-party dependencies |
   | `CONCERNS.md` | Tech debt, known issues, TODO comments, risks |

   Each document follows this format:
   ```markdown
   # [Category] — [Project Name]

   > Auto-generated by `/init` on [date]. Review and edit as needed.

   ## Summary
   [1-2 paragraphs overview]

   ## Details
   [Category-specific tables and structured content]
   ```

10. **Create STATE.md** — Initialize `docs/STATE.md` with project info and empty tracking sections.

11. **Present results** — Show the user:
    - Summary of detected tech stack
    - `project-config.md` changes (diff)
    - List of generated docs
    - Ask: "Does this look correct? Any corrections needed?"

## When to Use
- First time opening a project in this IDE
- After cloning/importing a project from another IDE (Cursor, Windsurf, etc.)
- When AI outputs feel generic or miss existing codebase context
- After major architectural changes (re-run to update docs)

## When to Skip
- Brand new project (nothing to scan yet)
- Project already has filled `project-config.md` and `docs/codebase/`
- Single-file scripts or trivial projects

## Future Extensions
- `--deep` — Scan ALL source files, generate API docs, analyze full dependency graph
- `--guided` — Interactive Q&A after scan for business context and domain knowledge
- `--focus [area]` — Regenerate only specific doc (e.g., `--focus testing`)

---

## /init reload

Re-read all rule files so changes take effect in the current conversation.
*(Previously: `/reload`)*

### Steps

1. **Re-read all rules** — Read every file in `.agent/rules/`:
   - `.agent/rules/super-compound.md` — Core philosophy, skills, workflows, git
   - `.agent/rules/project-config.md` — Tech stack config, presets, auto-detect
   - `.agent/rules/quality-gates.md` — Verification, knowledge, architecture rules

2. **Confirm changes** — Report what changed since last load:
   > "✅ Rules reloaded. Changes detected in: [list of modified files]"

3. **Apply immediately** — All subsequent responses follow the updated rules.

### When to Use
- After editing any file in `.agent/rules/`
- After changing project config (preset, tech stack, commands)
- Mid-conversation when rules feel outdated
